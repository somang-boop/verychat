"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.waitForDeployment = waitForDeployment;
const api_js_1 = require("./api.js");
/**
 * Poll deployment status until it reaches "running" or "failed".
 * Returns the final status string.
 */
async function waitForDeployment(appId, depId, maxAttempts = 60, intervalMs = 2000) {
    let status = "pending";
    let attempts = 0;
    while (status !== "running" && status !== "failed" && attempts < maxAttempts) {
        await new Promise((r) => setTimeout(r, intervalMs));
        try {
            const dep = await (0, api_js_1.apiRequest)(`/api/apps/${appId}/deployments/${depId}`);
            status = dep.status;
        }
        catch {
            // Retry on error
        }
        attempts++;
    }
    return status;
}
